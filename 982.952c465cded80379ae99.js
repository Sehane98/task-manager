"use strict";(self.webpackChunktask_manager=self.webpackChunktask_manager||[]).push([[982],{4982:(W,h,r)=>{r.r(h),r.d(h,{CustomerModule:()=>z});var C=r(8583),g=r(4655),d=r(3461),I=r(4395),F=r(7519),Z=r(5435),p=r(5062),L=r(8424),a=r(3679),l=r(2238),t=r(7716),U=r(5798),v=r(345),T=r(5674),x=r(8295),A=r(9983),f=r(1095);function S(e,i){1&e&&t._UZ(0,"i",13)}function _(e,i){if(1&e&&t._uU(0),2&e){const o=t.oxw();t.Oqu(o.data?"Update":"Create")}}let D=(()=>{class e{constructor(o,s,n,u,c,H){this.dialogRef=o,this.formBuilder=s,this.coreService=n,this.snackBarService=u,this.authService=c,this.data=H,this.loading=!1,this.currentUser=this.authService.getCurrentUser()}ngOnInit(){this.initCustomerUpInitForm()}initCustomerUpInitForm(){this.customerUpInitForm=this.formBuilder.group({id:[null],name:[null,[a.kI.required]],password:["defaultPassword"],surname:[null,[a.kI.required]],email:[null,[a.kI.required,a.kI.email]],role:["ROLE_USER"],userId:[this.currentUser.id]}),this.data&&(this.customerUpInitForm.removeControl("password"),this.setCustomerUpInitForm())}setCustomerUpInitForm(){this.customerUpInitForm.patchValue({id:this.data.id,surname:this.data.surname,name:this.data.name,email:this.data.email})}submit(){this.customerUpInitForm.disable(),this.loading=!0;const o=Object.assign(Object.assign({},this.data),this.customerUpInitForm.value);this.data?this.updateCustomer(o):(delete o.id,this.createCustomer(o))}createCustomer(o){this.coreService.post(p.i.URL.customers,o).subscribe(()=>{this.dialogRef.close({created:!0})},s=>{this.snackBarService.error(s),this.customerUpInitForm.enable(),this.loading=!1})}updateCustomer(o){delete o.password,this.coreService.put(p.i.URL.customers,o).subscribe(()=>{this.dialogRef.close({created:!1})},s=>{this.snackBarService.error(s),this.customerUpInitForm.enable(),this.loading=!1})}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(l.so),t.Y36(a.qu),t.Y36(U.p),t.Y36(v.c),t.Y36(T.e),t.Y36(l.WI))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-customer-update"]],decls:24,vars:5,consts:[["mat-dialog-title","",1,"text-center"],["mat-dialog-content",""],[1,"p-t-b-1"],["id","customerUpInitForm",1,"form-horizontal","full-width-form",3,"formGroup","ngSubmit"],["appearance","outline",1,"w-100"],["type","text","matInput","","autocomplete","name","placeholder","Name","formControlName","name"],["type","text","matInput","","autocomplete","surname","placeholder","Password","formControlName","surname"],["type","email","matInput","","autocomplete","email","placeholder","Email","formControlName","email"],[1,"row","submit-button-group"],["type","submit","mat-flat-button","","color","primary","form","customerUpInitForm",3,"disabled"],["class","fa fa-spinner fa-pulse fa-3x fa-fw",4,"ngIf","ngIfElse"],["btnText",""],["mat-stroked-button","","mat-dialog-close",""],[1,"fa","fa-spinner","fa-pulse","fa-3x","fa-fw"]],template:function(o,s){if(1&o&&(t.TgZ(0,"h1",0),t._uU(1),t.qZA(),t.TgZ(2,"div",1),t.TgZ(3,"div",2),t.TgZ(4,"form",3),t.NdJ("ngSubmit",function(){return s.submit()}),t.TgZ(5,"mat-form-field",4),t.TgZ(6,"mat-label"),t._uU(7,"Name"),t.qZA(),t._UZ(8,"input",5),t.qZA(),t.TgZ(9,"mat-form-field",4),t.TgZ(10,"mat-label"),t._uU(11,"Surname"),t.qZA(),t._UZ(12,"input",6),t.qZA(),t.TgZ(13,"mat-form-field",4),t.TgZ(14,"mat-label"),t._uU(15,"Email"),t.qZA(),t._UZ(16,"input",7),t.qZA(),t.qZA(),t.qZA(),t.TgZ(17,"div",8),t.TgZ(18,"button",9),t.YNc(19,S,1,0,"i",10),t.YNc(20,_,1,1,"ng-template",null,11,t.W1O),t.qZA(),t.TgZ(22,"button",12),t._uU(23,"Cancel"),t.qZA(),t.qZA(),t.qZA()),2&o){const n=t.MAs(21);t.xp6(1),t.hij(" ",s.data?"Update customer":"Create customer","\n"),t.xp6(3),t.Q6J("formGroup",s.customerUpInitForm),t.xp6(14),t.Q6J("disabled",s.loading||!s.customerUpInitForm.valid),t.xp6(1),t.Q6J("ngIf",s.loading)("ngIfElse",n)}},directives:[l.uh,l.xY,a._Y,a.JL,a.sg,x.KE,x.hX,A.Nt,a.Fj,a.JJ,a.u,f.lW,C.O5,l.ZT],styles:[""]}),e})();var m=r(2789),b=r(6627);function N(e,i){1&e&&(t.TgZ(0,"th",13),t._uU(1,"No."),t.qZA())}function Y(e,i){if(1&e&&(t.TgZ(0,"td",14),t._uU(1),t.qZA()),2&e){const o=i.$implicit;t.xp6(1),t.Oqu(o.id)}}function y(e,i){1&e&&(t.TgZ(0,"th",13),t._uU(1,"Name"),t.qZA())}function k(e,i){if(1&e&&(t.TgZ(0,"td",14),t._uU(1),t.qZA()),2&e){const o=i.$implicit;t.xp6(1),t.Oqu(o.name)}}function B(e,i){1&e&&(t.TgZ(0,"th",13),t._uU(1,"Surname"),t.qZA())}function R(e,i){if(1&e&&(t.TgZ(0,"td",14),t._uU(1),t.qZA()),2&e){const o=i.$implicit;t.xp6(1),t.Oqu(o.surname)}}function q(e,i){1&e&&(t.TgZ(0,"th",13),t._uU(1,"Email"),t.qZA())}function J(e,i){if(1&e&&(t.TgZ(0,"td",14),t._uU(1),t.qZA()),2&e){const o=i.$implicit;t.xp6(1),t.Oqu(o.email)}}function O(e,i){1&e&&(t.TgZ(0,"th",13),t._uU(1,"Actions"),t.qZA())}function Q(e,i){if(1&e){const o=t.EpF();t.TgZ(0,"td",14),t.TgZ(1,"span",15),t.TgZ(2,"mat-icon",16),t.NdJ("click",function(){const u=t.CHM(o).$implicit;return t.oxw().upInit(u)}),t._uU(3,"edit"),t.qZA(),t.TgZ(4,"mat-icon",16),t.NdJ("click",function(){const u=t.CHM(o).$implicit;return t.oxw().openDeleteConfirmDialog(u)}),t._uU(5,"delete"),t.qZA(),t.qZA(),t.qZA()}}function w(e,i){1&e&&t._UZ(0,"tr",17)}function M(e,i){1&e&&t._UZ(0,"tr",18)}const j=[{path:"",component:(()=>{class e{constructor(o,s,n,u,c){this.dialog=o,this.formBuilder=s,this.snackBarService=n,this.coreService=u,this.authService=c,this.columns=["id","name","surname","email","actions"],this.dataSource=[],this.tableLoading=!1,this.currentUser=this.authService.getCurrentUser()}drop(o){(0,d.bA)(this.columns,o.previousIndex,o.currentIndex)}ngOnInit(){this.initCustomerFilterForm(),this.getAllCustomers()}getAllCustomers(){const o=Object.assign({},this.customerFilterForm.value);this.tableLoading=!0,this.coreService.get(p.i.URL.customers,o).subscribe(s=>{this.dataSource=s.body},s=>{this.snackBarService.error(s)}).add(()=>this.tableLoading=!1)}initCustomerFilterForm(){this.customerFilterForm=this.formBuilder.group({count:[0],page:[0],sort:["id,desc"],size:[15],userId:[this.currentUser.id]}),this.subscribeFilterForm()}subscribeFilterForm(){this.customerFilterForm.valueChanges.pipe((0,I.b)(1e3),(0,F.x)()).subscribe(()=>{this.getAllCustomers()})}upInit(o){this.dialog.open(D,{width:"auto",height:"auto",data:o||null,maxWidth:"400px"}).afterClosed().pipe((0,Z.h)(n=>!!n)).subscribe(n=>{this.snackBarService.success(n.created?"Customer successfully created":"Customer successfully updated"),this.getAllCustomers()})}openDeleteConfirmDialog(o){this.dialog.open(L.h,{width:"350px",height:"auto",data:{id:o.id,message:"Are you sure?",delete:n=>this.coreService.delete(p.i.URL.customers+"/"+o.id,o.id)}}).afterClosed().pipe((0,Z.h)(n=>!!n)).subscribe(()=>{this.snackBarService.success("Successfully deleted!"),this.getAllCustomers()})}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(l.uw),t.Y36(a.qu),t.Y36(v.c),t.Y36(U.p),t.Y36(T.e))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-customer-list"]],decls:22,vars:3,consts:[[1,"create","p-4"],["mat-stroked-button","","color","primary",3,"click"],[1,"mt-3"],["mat-table","","cdkDropList","","cdkDropListOrientation","horizontal",3,"dataSource","cdkDropListDropped"],["matColumnDef","id"],["mat-header-cell","","cdkDrag","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","surname"],["matColumnDef","email"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell","","cdkDrag",""],["mat-cell",""],[1,"actions"],[3,"click"],["mat-header-row",""],["mat-row",""]],template:function(o,s){1&o&&(t.TgZ(0,"div",0),t.TgZ(1,"button",1),t.NdJ("click",function(){return s.upInit()}),t._uU(2,"+ Create customer"),t.qZA(),t.qZA(),t.TgZ(3,"div",2),t.TgZ(4,"table",3),t.NdJ("cdkDropListDropped",function(u){return s.drop(u)}),t.ynx(5,4),t.YNc(6,N,2,0,"th",5),t.YNc(7,Y,2,1,"td",6),t.BQk(),t.ynx(8,7),t.YNc(9,y,2,0,"th",5),t.YNc(10,k,2,1,"td",6),t.BQk(),t.ynx(11,8),t.YNc(12,B,2,0,"th",5),t.YNc(13,R,2,1,"td",6),t.BQk(),t.ynx(14,9),t.YNc(15,q,2,0,"th",5),t.YNc(16,J,2,1,"td",6),t.BQk(),t.ynx(17,10),t.YNc(18,O,2,0,"th",5),t.YNc(19,Q,6,0,"td",6),t.BQk(),t.YNc(20,w,1,0,"tr",11),t.YNc(21,M,1,0,"tr",12),t.qZA(),t.qZA()),2&o&&(t.xp6(4),t.Q6J("dataSource",s.dataSource),t.xp6(16),t.Q6J("matHeaderRowDef",s.columns),t.xp6(1),t.Q6J("matRowDefColumns",s.columns))},directives:[f.lW,m.BZ,d.Wj,m.w1,m.fO,m.Dz,m.as,m.nj,m.ge,d.Zt,m.ev,b.Hw,m.XQ,m.Gk],styles:[""]}),e})()}];let E=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[g.Bz.forChild(j)],g.Bz]}),e})(),z=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[C.ez,E,d._t,m.p0,f.ot,l.Is,A.c,b.Ps,a.UX]]}),e})()}}]);